---
phase: 06-habits-tasks-remaining-pages-migration
plan: 03
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - components/tasks/tasks-page-content.tsx
  - components/tasks/task-detail-content.tsx
  - components/tasks/create-task-content.tsx
  - components/tasks/edit-task-content.tsx
  - components/settings/settings-content.tsx
  - tests/components/tasks/tasks-page-content.test.tsx
  - tests/components/tasks/task-detail-content.test.tsx
  - tests/components/tasks/create-task-content.test.tsx
  - tests/components/tasks/edit-task-content.test.tsx
autonomous: true
requirements:
  - VISL-10

must_haves:
  truths:
    - "Tasks list page uses PageHeader with title and Create button in actions slot"
    - "Task detail page shows breadcrumbs (Tasks > task title) above PageHeader"
    - "Task detail page wraps all content in a single Card"
    - "Task create page shows breadcrumbs (Tasks > New Task) with form in Card"
    - "Task edit page shows breadcrumbs (Tasks > task title) with form in Card"
    - "Create/edit task pages have Save/Cancel in PageHeader actions slot using form attribute"
    - "Settings page uses PageHeader with Save button in actions slot"
    - "Settings page keeps multi-card layout (no container Card wrapping)"
    - "All task and settings tests pass after migration"
  artifacts:
    - path: "components/tasks/tasks-page-content.tsx"
      provides: "Tasks list with PageHeader"
      contains: "PageHeader"
    - path: "components/tasks/task-detail-content.tsx"
      provides: "Task detail with breadcrumbs, PageHeader, Card wrapping"
      contains: "PageBreadcrumbs"
    - path: "components/tasks/create-task-content.tsx"
      provides: "Create task with breadcrumbs, PageHeader, Card-wrapped form"
      contains: "PageBreadcrumbs"
    - path: "components/tasks/edit-task-content.tsx"
      provides: "Edit task with breadcrumbs, PageHeader, Card-wrapped form"
      contains: "PageBreadcrumbs"
    - path: "components/settings/settings-content.tsx"
      provides: "Settings with PageHeader"
      contains: "PageHeader"
  key_links:
    - from: "components/tasks/task-detail-content.tsx"
      to: "components/layouts/page-breadcrumbs.tsx"
      via: "breadcrumb navigation"
      pattern: "PageBreadcrumbs.*section.*tasks"
    - from: "components/tasks/create-task-content.tsx"
      to: "components/tasks/task-form.tsx"
      via: "hideChrome and form id props"
      pattern: "hideChrome|form.*task-form"
---

<objective>
Migrate all 4 tasks pages (list, detail, create, edit) and the settings page to the new card-on-gray layout with PageHeader and breadcrumbs.

Purpose: Tasks pages follow the same migration pattern as habits (plan 06-02). Settings page is a simple PageHeader swap. This plan can run in parallel with 06-02 since they touch different files.

Output: All tasks and settings pages using PageHeader, breadcrumbs on nested views, Card wrapping on detail/form pages, updated tests.
</objective>

<execution_context>
@/home/xingdi/.claude/get-shit-done/workflows/execute-plan.md
@/home/xingdi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-habits-tasks-remaining-pages-migration/06-RESEARCH.md
@.planning/phases/06-habits-tasks-remaining-pages-migration/06-01-SUMMARY.md
@components/tasks/tasks-page-content.tsx
@components/tasks/task-detail-content.tsx
@components/tasks/create-task-content.tsx
@components/tasks/edit-task-content.tsx
@components/tasks/task-form.tsx
@components/settings/settings-content.tsx
@components/layouts/page-header.tsx
@components/layouts/page-breadcrumbs.tsx
@tests/components/tasks/tasks-page-content.test.tsx
@tests/components/tasks/task-detail-content.test.tsx
@tests/components/tasks/create-task-content.test.tsx
@tests/components/tasks/edit-task-content.test.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate tasks list and detail pages to PageHeader and breadcrumbs</name>
  <files>
    components/tasks/tasks-page-content.tsx
    components/tasks/task-detail-content.tsx
    tests/components/tasks/tasks-page-content.test.tsx
    tests/components/tasks/task-detail-content.test.tsx
  </files>
  <action>
**Tasks list page (`tasks-page-content.tsx`):**

Follow the exact same pattern as habits list (06-02 Task 1). Replace inline header with PageHeader:
```tsx
import { PageHeader } from "@/components/layouts/page-header";

<PageHeader
  title={t("page.title")}
  actions={
    <Button onClick={handleCreateTask}>
      <Plus className="size-4 mr-2" />
      {t("page.createButton")}
    </Button>
  }
/>
```

Update TasksPageSkeleton similarly with PageHeaderSkeleton.

No breadcrumbs on list page. No Card wrapping (individual task cards float on gray).

**Task detail page (`task-detail-content.tsx`):**

Follow the same pattern as habit detail (06-02 Task 1):
1. Remove ArrowLeft back button
2. Add breadcrumbs: `<PageBreadcrumbs section="tasks" itemName={task.title} />`
3. Replace inline header with PageHeader, Edit button in actions slot
4. Wrap all content below header in a single Card with `max-w-3xl`
5. Remove outer `max-w-3xl mx-auto` from top-level div

```tsx
import { PageHeader } from "@/components/layouts/page-header";
import { PageBreadcrumbs } from "@/components/layouts/page-breadcrumbs";
import { Card, CardContent } from "@/components/ui/card";

// In the rendered output:
<div className="space-y-6">
  <div>
    <PageBreadcrumbs section="tasks" itemName={task.title} />
    <PageHeader
      title={task.title}
      actions={
        <Button onClick={() => router.push(`/tasks/${taskId}/edit`)} className="gap-2">
          <Edit className="size-4" />
          {t("detail.edit")}
        </Button>
      }
    />
  </div>
  <Card className="max-w-3xl">
    <CardContent className="space-y-6 pt-6">
      {/* All existing detail content: metadata, description, status, dates, delete action */}
    </CardContent>
  </Card>
</div>
```

Update skeleton to match. Remove ArrowLeft import.

**Update tests:**
- `tasks-page-content.test.tsx`: Title text assertions should survive. Update if needed.
- `task-detail-content.test.tsx`: Remove "Back to Tasks" button assertions. Update heading structure if tests query by role.
  </action>
  <verify>
Run `pnpm test:run -- --reporter verbose tests/components/tasks/tasks-page-content.test.tsx tests/components/tasks/task-detail-content.test.tsx` -- all tests pass. Run `pnpm lint`.
  </verify>
  <done>
Tasks list page uses PageHeader. Task detail page has breadcrumbs, PageHeader with Edit action, and all content wrapped in a Card. Back button removed. Tests updated and passing.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate tasks create/edit pages and settings page</name>
  <files>
    components/tasks/create-task-content.tsx
    components/tasks/edit-task-content.tsx
    components/settings/settings-content.tsx
    tests/components/tasks/create-task-content.test.tsx
    tests/components/tasks/edit-task-content.test.tsx
  </files>
  <action>
**Create task page (`create-task-content.tsx`):**

Follow the exact same pattern as create habit (06-02 Task 2):
```tsx
import { PageHeader } from "@/components/layouts/page-header";
import { PageBreadcrumbs } from "@/components/layouts/page-breadcrumbs";
import { Card, CardContent } from "@/components/ui/card";

const tBreadcrumb = useTranslations("tasks.breadcrumb");

return (
  <div className="space-y-6">
    <div>
      <PageBreadcrumbs section="tasks" itemName={tBreadcrumb("newTask")} />
      <PageHeader
        title={t("form.createTitle")}
        actions={
          <>
            <Button variant="ghost" onClick={handleCancel} disabled={isLoading}>
              {t("form.cancel")}
            </Button>
            <Button type="submit" form="task-form" disabled={isLoading}>
              {isLoading ? t("form.creating") : t("form.create")}
            </Button>
          </>
        }
      />
    </div>
    <Card className="max-w-2xl">
      <CardContent className="pt-6">
        <TaskForm
          id="task-form"
          mode="create"
          onSubmit={handleSubmit}
          onCancel={handleCancel}
          isLoading={isLoading}
          hideChrome
        />
      </CardContent>
    </Card>
  </div>
);
```

**Edit task page (`edit-task-content.tsx`):**

Same pattern as edit habit. Breadcrumb uses task.title:
```tsx
<PageBreadcrumbs section="tasks" itemName={task.title} />
<PageHeader title={t("form.editTitle")} actions={...} />
<Card className="max-w-2xl">
  <CardContent className="pt-6">
    <TaskForm id="task-form" mode="edit" initialData={task} onSubmit={...} onCancel={...} isLoading={...} hideChrome />
  </CardContent>
</Card>
```

Update skeleton and error state wrappers.

**Settings page (`settings-content.tsx`):**

Simple migration -- replace inline header with PageHeader:
```tsx
import { PageHeader } from "@/components/layouts/page-header";

// Replace:
// <div className="flex items-center justify-between">
//   <h1 className="text-2xl font-bold">{t("title")}</h1>
//   <Button ...>Save</Button>
// </div>

// With:
<PageHeader
  title={t("title")}
  actions={
    <Button onClick={handleSave} disabled={!hasChanges || isSaving}>
      {saveSuccess ? (
        <><CheckCircle className="size-4 mr-2" />{t("saved")}</>
      ) : isSaving ? (
        <><Loader2 className="size-4 mr-2 animate-spin" />{t("saving")}</>
      ) : (
        <><Save className="size-4 mr-2" />{t("save")}</>
      )}
    </Button>
  }
/>
```

Also update the error state header to use PageHeader. No breadcrumbs on settings (top-level page). Multi-card layout stays as-is (locked decision).

**Update tests:**
- `create-task-content.test.tsx`: Update heading and button location assertions.
- `edit-task-content.test.tsx`: Same adjustments.
- No settings test file exists, so no test updates needed.
  </action>
  <verify>
Run `pnpm test:run -- --reporter verbose tests/components/tasks/create-task-content.test.tsx tests/components/tasks/edit-task-content.test.tsx` -- all tests pass. Run `pnpm lint`.
  </verify>
  <done>
Create and edit task pages show breadcrumbs, use PageHeader with Save/Cancel in actions slot, and wrap the form in a Card. Settings page uses PageHeader with Save button. All tests updated and passing.
  </done>
</task>

</tasks>

<verification>
1. `pnpm test:run -- --reporter verbose tests/components/tasks/` -- all task-related tests pass
2. `pnpm lint` passes
3. Visual check: Tasks list has PageHeader, detail has breadcrumbs + Card, create/edit have breadcrumbs + Card + PageHeader actions, settings uses PageHeader
</verification>

<success_criteria>
- All 4 tasks pages migrated to PageHeader with consistent layout
- Settings page migrated to PageHeader
- Detail page: breadcrumbs replace back button, content wrapped in Card
- Create/edit pages: breadcrumbs, form in Card, Save/Cancel in PageHeader
- All existing tests updated and passing
</success_criteria>

<output>
After completion, create `.planning/phases/06-habits-tasks-remaining-pages-migration/06-03-SUMMARY.md`
</output>
